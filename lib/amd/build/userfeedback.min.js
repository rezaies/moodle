define ("core/userfeedback",["exports","core/ajax","core/notification"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.registerEventListeners=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function f(a){return function(){var b=this,c=arguments;return new Promise(function(d,f){var i=a.apply(b,c);function g(a){e(i,d,f,g,h,"next",a)}function h(a){e(i,d,f,g,h,"throw",a)}g(void 0)})}}var g={actions:{give:"a[data-action=\"give\"]",remind:"a[data-action=\"remind\"]"}};a.registerEventListeners=function registerEventListeners(a){var b=document.querySelector(a);b.addEventListener("click",function(a){var d=a.target.closest(g.actions.give);if(d){a.preventDefault();var e=!!d.dataset.record,i=!!d.dataset.hide;h().then(function(){return e?j("give"):null}).then(function(){if(i){b.remove()}}).catch(c.default.exception)}var k=a.target.closest(g.actions.remind);if(k){a.preventDefault();var l=!!k.dataset.record,m=!!k.dataset.hide;f(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:return a.abrupt("return",l?j("remind"):null);case 1:case"end":return a.stop();}}},a)}))().then(function(){if(m){b.remove()}}).catch(c.default.exception)}})};var h=function(){return b.default.call([{methodname:"core_get_userfeedback_data",args:{contextid:M.cfg.contextid}}])[0].then(function(a){return i(a)}).then(function(a){if(!window.open(a)){throw new Error("Unable to open popup")}})},i=function(a){var b=-1==a.feedbackurl.indexOf("?")?"?":"&";return a.feedbackurl+b+"lang="+a.lang+"&moodle_url="+encodeURIComponent(a.siteurl)+"&roles="+encodeURIComponent(a.roles.join())+"&moodle_version="+encodeURIComponent(a.version)+"&theme="+encodeURIComponent(a.theme)+"&theme_version="+encodeURIComponent(a.themeversion)},j=function(a){return b.default.call([{methodname:"core_create_userfeedback_action_record",args:{action:a,contextid:M.cfg.contextid}}])[0]}});
//# sourceMappingURL=userfeedback.min.js.map
