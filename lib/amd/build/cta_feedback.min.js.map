{"version":3,"sources":["../src/cta_feedback.js"],"names":["SELECTORS","actions","give","remind","registerActions","rootSelector","root","document","querySelector","giveAction","remindAction","addEventListener","e","preventDefault","giveFeedback","remindLater","setAttribute","registerFeedbackLink","elementSelector","element","remove","window","open","Ajax","call","methodname","args","action"],"mappings":"gLAuBA,uD,GAEMA,CAAAA,CAAS,CAAG,CACdC,OAAO,CAAE,CACLC,IAAI,CAAE,yBADD,CAELC,MAAM,CAAE,2BAFH,CADK,C,mBAYa,QAAlBC,CAAAA,eAAkB,CAAAC,CAAY,CAAI,IACrCC,CAAAA,CAAI,CAAGC,QAAQ,CAACC,aAAT,CAAuBH,CAAvB,CAD8B,CAErCI,CAAU,CAAGH,CAAI,CAACE,aAAL,CAAmBR,CAAS,CAACC,OAAV,CAAkBC,IAArC,CAFwB,CAGrCQ,CAAY,CAAGJ,CAAI,CAACE,aAAL,CAAmBR,CAAS,CAACC,OAAV,CAAkBE,MAArC,CAHsB,CAK3CM,CAAU,CAACE,gBAAX,CAA4B,OAA5B,CAAqC,SAAAC,CAAC,CAAI,CACtCA,CAAC,CAACC,cAAF,GACAC,CAAY,EACf,CAHD,EAIAJ,CAAY,CAACC,gBAAb,CAA8B,OAA9B,CAAuC,SAAAC,CAAC,CAAI,CACxCA,CAAC,CAACC,cAAF,GACAE,CAAW,EACd,CAHD,EAKAN,CAAU,CAACO,YAAX,CAAwB,cAAxB,CAAwC,OAAxC,EACAN,CAAY,CAACM,YAAb,CAA0B,cAA1B,CAA0C,OAA1C,CACH,C,wBAOmC,QAAvBC,CAAAA,oBAAuB,CAAAC,CAAe,CAAI,IAC7CC,CAAAA,CAAO,CAAGZ,QAAQ,CAACC,aAAT,CAAuBU,CAAvB,CADmC,CAE7CT,CAAU,CAAGU,CAAO,CAACX,aAAR,CAAsBR,CAAS,CAACC,OAAV,CAAkBC,IAAxC,CAFgC,CAInDO,CAAU,CAACE,gBAAX,CAA4B,OAA5B,CAAqC,SAAAC,CAAC,CAAI,CACtCA,CAAC,CAACC,cAAF,GACAC,CAAY,GACZK,CAAO,CAACC,MAAR,EACH,CAJD,CAKH,C,IAKKN,CAAAA,CAAY,CAAG,UAAM,CAEvBO,MAAM,CAACC,IAAP,gCASAC,UAAKC,IAAL,CAAU,CAPM,CACZC,UAAU,CAAE,mCADA,CAEZC,IAAI,CAAE,CACFC,MAAM,CAAE,MADN,CAFM,CAON,CAAV,CACH,C,CAKKZ,CAAW,CAAG,UAAM,CAQtBQ,UAAKC,IAAL,CAAU,CAPM,CACZC,UAAU,CAAE,iCADA,CAEZC,IAAI,CAAE,CACFC,MAAM,CAAE,QADN,CAFM,CAON,CAAV,CACH,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle clicking on action links of the feedback alert.\n *\n * @module     core/cta_feedback\n * @copyright  2020 Shamim Rezaie <shamim@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\n\nconst SELECTORS = {\n    actions: {\n        give: 'a[data-action=\"give\"]',\n        remind: 'a[data-action=\"remind\"]',\n    },\n};\n\n/**\n * Attach the necessary event handlers to the action links\n *\n * @param {string} rootSelector The css selector of the container that contains action links.\n */\nexport const registerActions = rootSelector => {\n    const root = document.querySelector(rootSelector);\n    const giveAction = root.querySelector(SELECTORS.actions.give);\n    const remindAction = root.querySelector(SELECTORS.actions.remind);\n\n    giveAction.addEventListener('click', e => {\n        e.preventDefault();\n        giveFeedback();\n    });\n    remindAction.addEventListener('click', e => {\n        e.preventDefault();\n        remindLater();\n    });\n\n    giveAction.setAttribute('data-dismiss', 'alert');\n    remindAction.setAttribute('data-dismiss', 'alert');\n};\n\n/**\n * Attach the necessary event handler to the give feedback link\n *\n * @param {string} elementSelector The css selector of the parent element\n */\nexport const registerFeedbackLink = elementSelector => {\n    const element = document.querySelector(elementSelector);\n    const giveAction = element.querySelector(SELECTORS.actions.give);\n\n    giveAction.addEventListener('click', e => {\n        e.preventDefault();\n        giveFeedback();\n        element.remove();\n    });\n};\n\n/**\n * The action function that is called when users choose to give feedback.\n */\nconst giveFeedback = () => {\n    const surveyUrl = 'https://feedback.moodle.org';\n    window.open(surveyUrl);\n\n    const request = {\n        methodname: 'core_cta_feedback_record_response',\n        args: {\n            action: 'give',\n        }\n    };\n\n    Ajax.call([request]);\n};\n\n/**\n * The action function that is called when users choose the remind later action.\n */\nconst remindLater = () => {\n    const request = {\n        methodname: 'core_cta_feedback_record_action',\n        args: {\n            action: 'remind',\n        }\n    };\n\n    Ajax.call([request]);\n};\n"],"file":"cta_feedback.min.js"}